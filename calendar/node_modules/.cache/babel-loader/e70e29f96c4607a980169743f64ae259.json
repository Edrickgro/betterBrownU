{"ast":null,"code":"// Import the functions you need from the SDKs you need\nimport { initializeApp } from \"firebase/app\";\nimport { getDatabase, ref, set, onValue } from 'firebase/database'; // TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n// Your web app's Firebase configuration\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDLBfzKNUMzRvsP_LeiRf31EJ-mJPVtf0o\",\n  authDomain: \"cs32termproject.firebaseapp.com\",\n  projectId: \"cs32termproject\",\n  storageBucket: \"cs32termproject.appspot.com\",\n  messagingSenderId: \"586091400920\",\n  appId: \"1:586091400920:web:a8a56afdc0bee2fd3ad1ad\",\n  measurementId: \"G-VP24Q6Q0E3\"\n}; // Structure of dates and events as defined in calendar.tsx\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nconst db = getDatabase();\n\nfunction nextValidID(date) {\n  const dateRef = ref(db, 'Dates/' + date);\n  let numChildren = 0;\n  onValue(dateRef, dateSnapshot => {\n    // if the date does exist, id is number of children\n    if (dateSnapshot.exists()) {\n      dateSnapshot.forEach(eventSnapshot => {\n        numChildren++;\n      });\n    }\n  });\n  return numChildren;\n}\n/**\n * Put an event into the database \n * \n * TODO: modify to just take a date object?\n * @param eventName \n * @param startTime \n * @param endTime \n * @param info \n * @param date \n * @param eventID \n */\n\n\nfunction writeNewEvent(event, date) {\n  const validID = nextValidID(date);\n  const reference = ref(db, 'Dates/' + date + '/' + validID);\n  set(reference, {\n    eventName: event.eventName,\n    startTime: event.startTime,\n    endTime: event.endTime,\n    info: event.info\n  });\n}\n/**\n * Given a string for a date, get all of the events for the date\n * @returns a list of event objects\n */\n\n\nfunction getDateEvents(date) {\n  const eventsRef = ref(db, 'Dates/' + date);\n  let retEvents = []; // get the events at this date\n\n  onValue(eventsRef, snapshot => {\n    // iterate and add each to return list\n    snapshot.forEach(childSnapshot => {\n      const currEvent = childSnapshot.val();\n      retEvents.push(currEvent.val);\n    });\n  });\n  return retEvents;\n}\n/**\n * Get all of the dates that have been added to the database.\n * @returns a list of dateInfo objects\n */\n\n\nfunction getAllDates() {\n  const datesRef = ref(db, 'Dates/');\n  const swRef = ref(db, datesRef.key + \"/\" + \"2022-04-29\");\n  const badRef = ref(db, datesRef.key + \"/\" + \"bad_ref\"); // TODO: child() doesn't work? shitty workaround\n\n  let retDates = []; // get all dates that have been added\n  //TODO: figure out how to loop through the fucking keys\n  // snapshot is of Dates\n\n  onValue(datesRef, dirSnapshot => {\n    console.log(\"Onvalue was called \" + dirSnapshot.key); // iterate and add each to return list\n    //iterating through dates\n\n    dirSnapshot.forEach(dateSnapshot => {\n      //TODO: could be an error depending on how date directories work \"'/' creates an additional layer\"\n      // console.log(\"child of child\" + dateSnapshot.key) // TODO: \n      // add each event to date's event list\n      let dateEvents = [];\n      dateSnapshot.forEach(eventSnapshot => {\n        console.log(\"event val: \" + eventSnapshot.val());\n        const currEvent = eventSnapshot.val();\n        const newEvent = {\n          startTime: currEvent.startTime,\n          endTime: currEvent.endTime,\n          eventName: currEvent.eventName,\n          info: currEvent.info\n        };\n        dateEvents.push(newEvent);\n      }); // create date, add eventList to it, add to dateList\n\n      const newDate = {\n        date: dateSnapshot.key,\n        events: dateEvents\n      };\n      retDates.push(newDate);\n    });\n  });\n  return retDates;\n} // writeEvent(\"Spring Weekend\", \"18:30\", \"22:30\", \"Annual thing\", \"2022-04-29\", \"0\");\n// writeEvent(\"lunch\", \"12:00\", \"13:00\", \"food optional\", \"2022-04-29\", \"1\");\n// TODO: figure out what to export\n\n\nexport { getAllDates, writeNewEvent };","map":{"version":3,"sources":["/home/ivan/github/cs32/term-project-ckaleel-eguerre1-hzheng29-ihuerta-nmcgrego/calendar/src/CalendarFB.ts"],"names":["initializeApp","getDatabase","ref","set","onValue","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","app","db","nextValidID","date","dateRef","numChildren","dateSnapshot","exists","forEach","eventSnapshot","writeNewEvent","event","validID","reference","eventName","startTime","endTime","info","getDateEvents","eventsRef","retEvents","snapshot","childSnapshot","currEvent","val","push","getAllDates","datesRef","swRef","key","badRef","retDates","dirSnapshot","console","log","dateEvents","newEvent","newDate","events"],"mappings":"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","sourcesContent":["// Import the functions you need from the SDKs you need\nimport { Console } from \"console\";\nimport { initializeApp } from \"firebase/app\";\nimport { getDatabase, ref, set, onValue} from 'firebase/database';\n\n\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Your web app's Firebase configuration\n// For Firebase JS SDK v7.20.0 and later, measurementId is optional\nconst firebaseConfig = {\n  apiKey: \"AIzaSyDLBfzKNUMzRvsP_LeiRf31EJ-mJPVtf0o\",\n  authDomain: \"cs32termproject.firebaseapp.com\",\n  projectId: \"cs32termproject\",\n  storageBucket: \"cs32termproject.appspot.com\",\n  messagingSenderId: \"586091400920\",\n  appId: \"1:586091400920:web:a8a56afdc0bee2fd3ad1ad\",\n  measurementId: \"G-VP24Q6Q0E3\"\n};\n\n// Structure of dates and events as defined in calendar.tsx\ntype dateInfo = {\n  date : string;\n  // each date has many events\n  events : event[];\n}\ntype event = {\n  eventName : string;\n  startTime : string;\n  endTime : string;\n  info : string;\n}\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nconst db = getDatabase();\n\nfunction nextValidID(date: string) : number { \n  const dateRef = ref(db, 'Dates/' + date);\n  let numChildren : number = 0;\n  onValue(dateRef, (dateSnapshot) => { \n    // if the date does exist, id is number of children\n    if (dateSnapshot.exists()) { \n      dateSnapshot.forEach((eventSnapshot) => { \n        numChildren++\n      })\n    }\n  })\n  return numChildren\n}\n\n/**\n * Put an event into the database \n * \n * TODO: modify to just take a date object?\n * @param eventName \n * @param startTime \n * @param endTime \n * @param info \n * @param date \n * @param eventID \n */\nfunction writeNewEvent(event: event, date: string) : void{ \n  const validID = nextValidID(date)\n  const reference = ref(db, 'Dates/' + date + '/' + validID);\n\n  set(reference, {\n    eventName: event.eventName,\n    startTime: event.startTime,\n    endTime: event.endTime,\n    info: event.info\n  })\n}\n\n/**\n * Given a string for a date, get all of the events for the date\n * @returns a list of event objects\n */\nfunction getDateEvents(date : string) : event[] {\n    const eventsRef = ref(db, 'Dates/' + date)\n    let retEvents : event[] = []\n    // get the events at this date\n    onValue(eventsRef, (snapshot) => {\n      // iterate and add each to return list\n      snapshot.forEach((childSnapshot) => {\n        const currEvent = childSnapshot.val();\n        retEvents.push(currEvent.val);\n      })  \n    });\n    return retEvents\n}\n\n/**\n * Get all of the dates that have been added to the database.\n * @returns a list of dateInfo objects\n */\nfunction getAllDates() : dateInfo[] { \n  const datesRef = ref(db, 'Dates/')\n  const swRef = ref(db, datesRef.key + \"/\" + \"2022-04-29\")\n  const badRef = ref(db, datesRef.key + \"/\" + \"bad_ref\")\n  // TODO: child() doesn't work? shitty workaround\n  let retDates : dateInfo[] = []\n  // get all dates that have been added\n\n  //TODO: figure out how to loop through the fucking keys\n  // snapshot is of Dates\n  onValue(datesRef, (dirSnapshot) => {\n    console.log(\"Onvalue was called \" + dirSnapshot.key)\n    // iterate and add each to return list\n    //iterating through dates\n    dirSnapshot.forEach((dateSnapshot) => {\n      //TODO: could be an error depending on how date directories work \"'/' creates an additional layer\"\n      // console.log(\"child of child\" + dateSnapshot.key) // TODO: \n      // add each event to date's event list\n      let dateEvents : event[] = [];\n      dateSnapshot.forEach((eventSnapshot) => {\n        console.log(\"event val: \" + eventSnapshot.val())\n        const currEvent = eventSnapshot.val();\n        const newEvent = <event>({\n          startTime: currEvent.startTime,\n          endTime: currEvent.endTime,\n          eventName: currEvent.eventName,\n          info: currEvent.info\n        });\n        dateEvents.push(newEvent)\n      })\n      // create date, add eventList to it, add to dateList\n      const newDate =  <dateInfo>({\n        date: dateSnapshot.key,\n        events: dateEvents\n      })\n      retDates.push(newDate)\n    })  \n  });\n  return retDates\n}\n\n// writeEvent(\"Spring Weekend\", \"18:30\", \"22:30\", \"Annual thing\", \"2022-04-29\", \"0\");\n// writeEvent(\"lunch\", \"12:00\", \"13:00\", \"food optional\", \"2022-04-29\", \"1\");\n\n// TODO: figure out what to export\nexport {getAllDates, writeNewEvent}"]},"metadata":{},"sourceType":"module"}